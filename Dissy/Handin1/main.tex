%%%%%     PACKS     %%%%%
\documentclass[12pt]{article}
\usepackage[margin=1in,headsep=.60in]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[table, dvipsnames]{xcolor}
\usepackage{array}
\usepackage{amsmath}
\usepackage{booktabs}
\usepackage{mdframed} %For box around text
\usepackage{hyperref} %For hyperlinks in the PDF
\hypersetup{
	colorlinks=true,
	linkcolor=blue,
	filecolor=magenta,
	urlcolor=cyan,
}
\urlstyle{same}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{siunitx}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{pgfplots}
\graphicspath{{Images/}}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage{cleveref}
\usepackage[labelformat=simple]{subcaption}
\usepackage{grffile}
\usepackage{gensymb}
\usepackage{float}
\usepackage[shortlabels]{enumitem}
\usepackage{enumitem}
\setlistdepth{9}
\usepackage{biblatex} %Imports biblatex package
\addbibresource{references.bib}
\usepackage{outlines}
\usepackage{minted}
\usepackage{pdflscape}
\usepackage{everypage}
\usepackage{multirow}
\usepackage{multicol}
\usepackage{afterpage}
\usepackage[labelfont=bf, font=small]{caption}
\usepackage{upgreek}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{listings}

% style sheet for code
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}

\lstset{style=mystyle}






\usepackage{lastpage}
%%%%%     COMMANDS     %%%%%
%%%% Blue box for subsection text (not figures) %%%%
\newenvironment{bluebox}
  {\begin{mdframed}[backgroundcolor=blue!5,linecolor=blue!40,roundcorner=8pt]}
  {\end{mdframed}}

%%%% Simple neutral box for figures %%%%
\newenvironment{figbox}
  {\begin{mdframed}[roundcorner=8pt,shadow=true,shadowsize=4pt,shadowcolor=black!40]}
  {\end{mdframed}}




\begin{document}

\begin{titlepage}
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}

\center

\textsc{\LARGE Aarhus university}\\[1.5cm]
\textsc{\Large Computer-Science}\\[0.5cm]
\textsc{\large Distributed Systems and Security}\\[0.5cm]
    

\HRule\\[0.4cm]
    \center 
    {\huge\bfseries Handin 0 }\\[0.4cm] % Title of your document
\HRule\\[1.5cm]

\begin{minipage}{0.4\textwidth}
        \begin{flushleft}
            \large
            \textit{Author}\\   
            SÃ¸ren M. \textsc{Damsgaard}\\
            Alexander\\
            Thor \textsc{behrmann}
                 % Your name
        \end{flushleft}
    \end{minipage}
~
    \begin{minipage}{0.4\textwidth}
        \begin{flushright}
            \large
            \textit{Student number}\\
            \textbf{202309814}\\
            \textbf{202408929}\\
            \textbf{202410271}
                 % Studienummer\
            
        \end{flushright}
    \end{minipage}

\vfill\vfill\vfill % Position the date 3/4 down the remaining page
    
    {\large\today}

\vfill\vfill
    \includegraphics[width=0.2\textwidth]{Aarhus_University_seal.png}\\[1cm] % Include a department/university logo - this will require the graphicx package
    

\vfill
\end{titlepage}
%%%%%      CHAPTERS      %%%%%
\hspace{0.02cm}

\section*{}

\subsection*{Messages with Framing and Serialization}
As explained in the assignment, TCP is a byte stream that needs encoding and a helping hand.\\
The encoding we used is the one recommended, the standard $\textsc{encoding/json}$ library, which was used to marshal the Message struct into JSON byte slices. When recieved it is then unmarshaled back into a struct. We chose JSON because it was recommended in the assignment and because of our previous experience with Java and Javascript.\\\\
For the framing of the messages we used a lenght prefix solution, because TCP might mess op the boundary/size of the message sent, or the amount of bytes read. The way it works is that we prefix every message with a 4-byte header holding the lenght of the message in the form of a basic 32-bit usigned integer. We specify and ue 32-bit for consistency and since any more would be 'overkill'.\\\\
When a Peer receives a messages it gets the prefix first by reading the 4 bytes to ascertain the size of the 'payload' and with the help of 'io.ReadFull' to read exactly the size of the payload based on the prefix/header..
\subsection*{How to Run the Code}
Move into the $./Handin\_1$ directory, should be the one sent through brightspace, with all the files in the same folder, main, test and the module.\\
To run the code you need to 'build' and then 'run' the code/file. Use the following commands in the terminal while you're in the mentionen directory.\\
\begin{lstlisting}[language=Python] 
go build ./handin0_main.go
go run ./handin0_main.go
\end{lstlisting}
This should run the main function in the code, which currently creates 3 Peers and connects them all, while sending a pair of test Messages.



\subsection*{How to Run Tests}
To run the automatic test-cases the only command needed is:
\begin{lstlisting}[language=Python] 
go test -v
\end{lstlisting}
This should run the test file and all its cases and announce wether any tests failed.

%put code in the appendix and refer to it here
\section*{Appendix}
Clearly a misguided appendixed left redundant after its creator realized that the code was not that long and could be easily included in the main text without a kerfuffle.\\
\printbibliography
\end{document}
